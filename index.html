<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© - Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø·Ø§Ø¦Ù</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="/path/to/buildings-data.js"></script>
<style>
.search-container input {
    width: 300px;
    padding: 7px 12px;
    font-size: 14px;
    border-radius: 6px;
    border: 1px solid #ccc;
}
</style>
<style>
    /* âœ… Ø³ØªØ§ÙŠÙ„ Ù„ØªØºÙŠÙŠØ± Ø´ÙƒÙ„ Ø§Ù„Ù…Ø¤Ø´Ø± Ø¥Ù„Ù‰ Ø¯Ø¨ÙˆØ³ */
    .cursor-pin {
        cursor: url('https://maps.gstatic.com/mapfiles/api-3/images/spotlight-poi2_hdpi.png') 16 32, auto;
    }
    </style>
    
<style>
    .direction-button {
        padding: 12px 20px;
        background-color: #007bff;
        color: white;
        font-size: 1.2em;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.2s;
        width: 100%;
    }
    
    .direction-button:hover {
        background-color: #0056b3;
        transform: scale(1.05);
    }
    </style>
<style>
    .category-list li {
        display: flex;
        align-items: center;
        cursor: pointer;
        padding: 8px;
        transition: transform 0.2s ease, background-color 0.2s ease;
        border-radius: 8px;
    }

    .category-list li img {
        width: 24px;
        height: 24px;
        margin-left: 8px;
        transition: transform 0.2s ease;
    }

    /* Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± Hover */
    .category-list li:hover {
        transform: scale(1.05);
        background-color: #f0f0f0;
    }

    /* Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Active */
    .category-list li:active {
        transform: scale(0.95);
        background-color: #e0e0e0;
    }

    .category-list li span {
        font-size: 16px;
        color: black;
    }
</style>

<style>
    /* âœ… Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ù…ÙˆØ¬ÙˆØ¯ Ø¹Ù†Ø¯Ùƒ Ø³Ø§Ø¨Ù‚Ø§Ù‹) */
    .sidebar .icon img {
        width: 40px;
        height: 40px;
        transition: transform 0.3s ease; /* âœ… Ø­Ø±ÙƒØ© Ù†Ø§Ø¹Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªÙƒØ¨ÙŠØ± */
    }
    
    /* âœ… Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
    .sidebar .icon:hover img {
        transform: scale(1.2); /* âœ… ØªÙƒØ¨ÙŠØ± Ø¨Ù†Ø³Ø¨Ø© 20% Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± */
    }
    
    /* âœ… Ø£ÙŠØ¶Ø§Ù‹ ØªÙƒØ¨ÙŠØ± Ø§Ù„Ù†Øµ Ù…Ø¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù„Ùˆ Ø£Ø±Ø¯Øª */
    .sidebar .icon:hover span {
        font-size: 16px; /* Ø§Ø®ØªÙŠØ§Ø±ÙŠØ§Ù‹: ØªÙƒØ¨ÙŠØ± Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± */
    }
    </style>
    
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; font-family: Arial, sans-serif; }
        #map { height: 100vh; width: 100%; position: absolute; top: 0; right: 0; z-index: 0; }
        #loadingMessage {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
            color: #007BFF;
            z-index: 1000;
            display: none;
        }

        /* âœ… Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø£Ø³ÙˆØ¯ ÙˆØ§Ù„ÙƒØªØ§Ø¨Ø© Ø¨ÙŠØ¶Ø§Ø¡ ÙˆØªÙƒØ¨ÙŠØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª */
        .sidebar {
            position: fixed;
            top: 0;
            right: 0;
            width: 80px; /* Ø£ÙƒØ¨Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
            height: 100%;
            background-color: #000;
            border-left: 1px solid #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 10px;
            z-index: 1001;
        }

        .sidebar .icon {
            margin: 20px 0;
            cursor: pointer;
            text-align: center;
            color: white;
        }

        .sidebar .icon img {
            width: 40px; /* âœ… ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª */
            height: 40px;
        }

        .sidebar .icon span {
            font-size: 14px;
            display: block;
            margin-top: 5px;
            color: white;
        }

        .sub-sidebar {
            position: fixed;
            top: 0;
            right: 80px; /* ØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø­Ø¬Ù… Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
            width: 220px;
            height: 100%;
            background-color: #111;
            border-left: 1px solid #333;
            padding: 10px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
            color: white;
        }

        .sub-sidebar h3, .sub-sidebar span, .sub-sidebar p {
            color: white;
        }

        #messageBox {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
            z-index: 2000;
            display: none;
        }

        #messageBox button {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #1e90ff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        /* Ø²Ø± ØªÙˆÙŠØªØ± */
        .twitter-button {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background-color: #1da1f2;
            color: white;
            border-radius: 5px;
            text-decoration: none;
            text-align: center;
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙˆÙ‡Ø¬ */
        svg .glow-path {
            filter: url(#glow-filter);
        }
    </style>
    <style>
        .topbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background-color: white;
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            direction: rtl;
        }
        
        .language-switch {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            font-size: 14px;
        }
        
        .language-switch button {
            background: none;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        
        .search-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 6px;
        }
        
        .search-container input {
            width: 300px;
            padding: 7px 77px;
            font-size: 15px;
            border-radius: 6px;
            border: 1px solid #ccc;
        }
        
        .search-container button {
            padding: 8px 16px;
            background-color: #007bff;
            border: none;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .logo img {
            width: 45px;
            cursor: pointer;
        }
        </style>
        <style>
            #visitTwitter:hover {
                box-shadow: 0 0 15px #007bff, 0 0 25px #007bff;
            }
        </style>
        <style>
            .search-container input {
                width: 300px; /* âœ… Ø¹Ø±Ø¶ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« */
                padding: 7px 12px; /* âœ… Ø§Ø±ØªÙØ§Ø¹ Ù…Ø±ÙŠØ­ ÙˆÙ…Ø³Ø§ÙØ© Ø¯Ø§Ø®Ù„ÙŠØ© Ù…Ù†Ø§Ø³Ø¨Ø© */
                font-size: 15px; /* âœ… Ø­Ø¬Ù… Ø§Ù„Ø®Ø· Ø¯Ø§Ø®Ù„ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« */
                border-radius: 6px;
                border: 1px solid #ccc;
            }
            
            /* âœ… ØªÙ†Ø³ÙŠÙ‚ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª */
            #suggestionsList {
                position: absolute;
                top: 100%;
                right: 0;
                width: 300px; /* âœ… Ù†ÙØ³ Ø¹Ø±Ø¶ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« */
                max-height: 250px; /* âœ… Ø§Ø±ØªÙØ§Ø¹ Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„ØªÙ…Ø±ÙŠØ± */
                background: white;
                border: 1px solid #ccc;
                overflow-y: auto;
                padding: 0;
                margin: 2px 0 0;
                list-style: none;
                border-radius: 0 0 6px 6px; /* âœ… ØªÙ‚Ø±ÙŠØ¨ Ø§Ù„Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ø³ÙÙ„ÙŠØ© Ù„Ù„Ø§Ù‚ØªØ±Ø§Ø¨ Ù…Ù† ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø­Ø« */
                z-index: 3000;
            }
            
            /* âœ… ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¯Ø§Ø®Ù„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª */
            #suggestionsList li {
                padding: 10px 12px; /* âœ… Ù…Ø³Ø§ÙØ© Ø¯Ø§Ø®Ù„ÙŠØ© Ù…Ø´Ø§Ø¨Ù‡Ø© Ù„Ù„Ø¨Ø­Ø« */
                cursor: pointer;
                font-size: 15px; /* âœ… Ù†ÙØ³ Ø­Ø¬Ù… Ø®Ø· Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« */
                border-bottom: 1px solid #eee;
            }
            
            /* âœ… ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†ØµØ± Ø§Ù‚ØªØ±Ø§Ø­ */
            #suggestionsList li:hover,
            #suggestionsList li.highlight {
                background-color: #007bff;
                color: white;
            }
            </style>
            
            <style>
                @keyframes spin {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }
                </style>
                
</head>
<!-- âœ… Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
<div id="loadingScreen" style="
    position: fixed; 
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 100%; 
    background: linear-gradient(to bottom right, #007bff, #66b3ff); 
    display: flex; 
    flex-direction: column; 
    justify-content: center; 
    align-items: center; 
    z-index: 3000;
">
<img src="/images/Ø´Ø¹Ø§Ø±_Ø¬Ø§Ù…Ø¹Ø©_Ø§Ù„Ø·Ø§Ø¦Ù_Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©.jpg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©" style="
width: 720px; 
max-width: 80%; 
border-radius: 20px; 
box-shadow: 0 4px 20px rgba(0,0,0,0.3); 
margin-bottom: 30px;
">

    <div style="display: flex; align-items: center; gap: 12px;">
        <span style="font-size: 22px; font-weight: bold; color: white;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
        <div class="spinner" style="
            width: 28px; 
            height: 28px; 
            border: 4px solid white; 
            border-top: 4px solid transparent; 
            border-radius: 50%; 
            animation: spin 1s linear infinite;">
        </div>
    </div>
</div>

<!-- âœ… Ø³ÙƒØ±Ø¨Øª Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ + ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ -->
<script>
window.addEventListener('load', function() {
    // Ù†Ù†ØªØ¸Ø± 5 Ø«ÙˆØ§Ù†ÙŠ Ù„Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
    setTimeout(function() {
        // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        document.getElementById('loadingScreen').style.display = 'none';

        // Ø«Ù… Ù†Ø³Ø£Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù† ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹
        if (confirm('ğŸ“ Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ ÙˆØ¹Ø±Ø¶Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©ØŸ')) {
            if (!navigator.geolocation) {
                alert('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ.');
                return;
            }

            navigator.geolocation.getCurrentPosition(
                function (position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;

                    // Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø±ÙƒØ± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Leaflet
                    const userMarker = L.marker([lat, lng], {
                        icon: L.icon({
                            iconUrl: 'https://cdn-icons-png.flaticon.com/512/64/64113.png',
                            iconSize: [40, 40],
                            iconAnchor: [20, 40]
                        })
                    }).addTo(map).bindPopup('ğŸ“ Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ').openPopup();

                    // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹
                    map.setView([lat, lng], 16);
                },
                function (error) {
                    alert('ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ: ' + error.message);
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
        } else {
            console.log('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø±ÙØ¶ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹.');
        }
    }, 5000); // âœ… Ù‡Ù†Ø§ Ø§Ù„Ù…Ø¯Ø© 5 Ø«ÙˆØ§Ù†ÙŠ Ø¨Ø¯Ù„ 4
});
</script>


<!-- âœ… Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
<div class="topbar">
    <div class="logo" style="display: flex; align-items: center;">
        <img src="/images/Ø´Ø¹Ø§Ø±_Ø¬Ø§Ù…Ø¹Ø©_Ø§Ù„Ø·Ø§Ø¦Ù_Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©.png" alt="Ø´Ø¹Ø§Ø±" onclick="showWelcomeVideo()" style="width: 120px; height: auto;">

    </div>
<!-- âœ… Ù†Ø§ÙØ°Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© -->
<div id="videoPopup" style="
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #fff;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 9999;
    text-align: center;
    max-width: 90%;
    max-height: 90%;
    opacity: 0;
    transition: opacity 0.4s ease-in-out;
">
    <h2 style="margin-bottom: 10px;">Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø·Ø§Ø¦Ù ØªØ±Ø­Ø¨ Ø¨ÙƒÙ…</h2>

    <div id="videoFrameContainer"></div>

    <br>
    <button onclick="closeWelcomeVideo()" style="margin-top: 10px;">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<script>
    window.addEventListener('load', function() {
        setTimeout(function() {
            document.getElementById('loadingScreen').style.display = 'none';
        }, 4000); // 4000ms = 4 Ø«ÙˆØ§Ù†ÙŠ
    });
    </script>
    
<!-- âœ… Ø³ÙƒØ±Ø¨Øª ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ -->
<script>
    const driveEmbedUrl = "https://drive.google.com/file/d/15ITjpqr7mY9kWqImi5LtkGyIKSDfPxeh/preview";

    function showWelcomeVideo() {
        const popup = document.getElementById("videoPopup");
        const container = document.getElementById("videoFrameContainer");

        // Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­
        container.innerHTML = `
            <iframe id="welcomeVideo"
                    src="${driveEmbedUrl}"
                    width="640" height="360"
                    allow="autoplay" allowfullscreen
                    style="border: none; border-radius: 10px;">
            </iframe>
        `;

        popup.style.display = "block";
        setTimeout(() => {
            popup.style.opacity = "1";
        }, 10);
    }

    function closeWelcomeVideo() {
        const popup = document.getElementById("videoPopup");
        const container = document.getElementById("videoFrameContainer");

        popup.style.opacity = "0";
        setTimeout(() => {
            popup.style.display = "none";
            container.innerHTML = ""; // ØªÙ†Ø¸ÙŠÙ ÙˆØ¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        }, 400);
    }

    // âœ… Ø±Ø¨Ø· Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¹Ø§Ø± Ù…Ø¹ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
    document.getElementById("universityLogo").addEventListener("click", showWelcomeVideo);
</script>
<div class="search-container" style="position: relative; display: flex; align-items: center; width: 600px;">
    <button id="searchButton" style="margin-left: 5px;">Ø¨Ø­Ø«</button>
    <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø¨Ù†Ù‰..." style="flex: 1;" />
    <ul id="suggestionsList" style="display: none;"></ul>
</div>


    

    <div class="language-switch">
        <button onclick="setLanguage('ar')">Ø¹Ø±Ø¨ÙŠ</button>
        <span>|</span>
        <button onclick="setLanguage('en')">English</button>
    </div>
</div>
<body>
<!-- âœ… ÙÙ„ØªØ± SVG Ù„Ù„ØªÙˆÙ‡Ø¬ -->
<svg height="0" width="0">
    <filter id="glow-filter" x="-50%" y="-50%" width="200%" height="200%">
        <feGaussianBlur stdDeviation="3.5" result="coloredBlur"/>
        <feMerge>
            <feMergeNode in="coloredBlur"/>
            <feMergeNode in="SourceGraphic"/>
        </feMerge>
    </filter>
</svg>

<!-- âœ… Ø§Ù„Ø®Ø±ÙŠØ·Ø© -->
<div id="map" style="position: absolute; top: 60px; left: 330px; right: 0; bottom: 0; z-index: 0;"></div>
<div id="loadingMessage" style="position: absolute; top: 70px; left: 340px; color: black;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø±ÙŠØ·Ø©...</div>

<!-- âœ… Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
<div class="sidebar" style="position: fixed; top: 60px; left: 0; width: 80px; height: calc(100vh - 60px); background-color: black; color: white; border-right: 1px solid #333; z-index: 1000; display: flex; flex-direction: column; align-items: center; padding-top: 10px;">
    <div class="icon" onclick="toggleSubSidebar('explore')" style="margin-bottom: 20px; text-align: center;">
        <img src="/images/explore-icon.png" alt="Ø§Ø³ØªÙƒØ´Ø§Ù" style="width: 40px;">
        <span data-key="explore" style="display: block; font-size: 12px;">Ø§Ø³ØªÙƒØ´Ø§Ù</span>
    </div>
    <div class="icon" onclick="toggleSubSidebar('places')" style="margin-bottom: 20px; text-align: center;">
        <img src="/images/location-icon.png" alt="Ø£Ù…Ø§ÙƒÙ†ÙŠ" style="width: 40px;">
        <span data-key="places" style="display: block; font-size: 12px;">Ø£Ù…Ø§ÙƒÙ†ÙŠ</span>
    </div>
    <div class="icon" onclick="toggleSubSidebar('directions')" style="margin-bottom: 20px; text-align: center;">
        <img src="/images/directions-icon.png" alt="Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª" style="width: 40px;">
        <span data-key="directions" style="display: block; font-size: 12px;">Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª</span>
    </div>
    <div class="icon" onclick="toggleSubSidebar('events')" style="margin-bottom: 20px; text-align: center;">
        <img src="/images/events-icon.png" alt="Ø§Ù„Ø£Ø­Ø¯Ø§Ø«" style="width: 40px;">
        <span data-key="events" style="display: block; font-size: 12px;">Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</span>
    </div>
    <div class="icon alert-icon" onclick="showMessage()" style="margin-top: auto; margin-bottom: 10px; text-align: center;">
        <img src="/images/light-bulb.png" alt="ØªØ¹Ø¬Ø¨" style="width: 40px;">
    </div>
</div>

<!-- âœ… Ø§Ù„Ø´Ø±Ø§Ø¦Ø· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø§Ù„ÙØ±Ø¹ÙŠØ© -->

<div id="explore" class="sub-sidebar" style="position: fixed; top: 60px; left: 80px; width: 250px; height: calc(100vh - 60px); background-color: white; color: black; border-right: 1px solid #ddd; overflow-y: auto; display: none; padding: 10px;">
    <h3 data-key="explore" style="color: black;">Ø§Ø³ØªÙƒØ´Ø§Ù</h3>
    <ul class="category-list" style="list-style: none; padding: 0;">
        <li onclick="showCategory('college')"><img src="/images/33.png" style="width: 20px;"> <span data-key="college">Ø§Ù„ÙƒÙ„ÙŠØ§Øª</span></li>
        <li onclick="showCategory('admin')"><img src="/images/77.png" style="width: 20px;"> <span data-key="admin">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</span></li>
        <li onclick="showCategory('medical')"><img src="/images/44.png" style="width: 20px;"> <span data-key="medical">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ©</span></li>
        <li onclick="showCategory('library')"><img src="/images/55.png" style="width: 20px;"> <span data-key="library">Ø§Ù„Ù…ÙƒØªØ¨Ø©</span></li>
        <li onclick="showCategory('mosque')"><img src="/images/11.png" style="width: 20px;"> <span data-key="mosque">Ø§Ù„Ù…Ø³Ø§Ø¬Ø¯</span></li>
        <li onclick="showCategory('restaurant')"><img src="/images/22.png" style="width: 20px;"> <span data-key="restaurant">Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</span></li>
    </ul>
</div>

<div id="places" class="sub-sidebar" style="position: fixed; top: 60px; left: 80px; width: 250px; height: calc(100vh - 60px); background-color: white; color: black; border-right: 1px solid #ddd; overflow-y: auto; display: none; padding: 10px;">
    <h3 data-key="places" style="color: black;">Ø£Ù…Ø§ÙƒÙ†ÙŠ</h3>

    <div id="placesContent"></div>
</div>

<div id="directions" class="sub-sidebar" style="position: fixed; top: 60px; left: 80px; width: 250px; height: calc(100vh - 60px); background-color: white; color: black; border-right: 1px solid #ddd; overflow-y: auto; display: none; padding: 10px;">
    <h3 data-key="directions" style="color: black;">Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª</h3>

    <div style="display: flex; flex-direction: column; gap: 10px;">
        <button id="startButton" onclick="setStartPoint()" class="direction-button" data-key="setStart" style="padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 5px;">
            ğŸ“ ØªØ­Ø¯ÙŠØ¯ Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
        </button>

        <button id="endButton" onclick="setEndPoint()" class="direction-button" data-key="setEnd" style="padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 5px;">
            ğŸ¯ ØªØ­Ø¯ÙŠØ¯ Ù†Ù‚Ø·Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
        </button>

        <button id="resetButton" onclick="resetRoute()" class="direction-button" data-key="reset" style="padding: 10px; background-color: #dc3545; color: white; border: none; border-radius: 5px;">
            ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
        </button>

        <div id="distanceInfo" data-key="distanceInfo" style="margin-top: 20px; padding: 12px; border: 2px dashed #007bff; border-radius: 10px; text-align: center; font-weight: bold;">
            Ø§Ù„Ù…Ø³Ø§ÙØ© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Ù‚Ø·ØªÙŠÙ†...
        </div>
    </div>
</div>


<div id="events" class="sub-sidebar" style="position: fixed; top: 60px; left: 80px; width: 250px; height: calc(100vh - 60px); background-color: white; color: black; border-right: 1px solid #ddd; overflow-y: auto; display: none; padding: 10px;">
    <h3 id="eventsTitle" data-key="events" style="color: black;">
        Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
    </h3>

    <div class="events-content">
        <p id="eventsInfo" data-key="eventsInfo" style="color: black; text-align: center;">
            Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ¢Ø®Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§ØªØŒ Ù‚Ù… Ø¨Ø²ÙŠØ§Ø±Ø© ØµÙØ­Ø© ØªÙˆÙŠØªØ± Ø§Ù„Ø±Ø³Ù…ÙŠØ©:
        </p>

        <a id="visitTwitter" data-key="visitTwitter" href="https://x.com/TaifUniversity" target="_blank"
           style="background-color: #007bff; color: white; padding: 10px 20px;
                  text-decoration: none; border-radius: 8px; display: inline-block;
                  font-weight: bold; transition: box-shadow 0.3s ease;">
            Ø²ÙŠØ§Ø±Ø© ØªÙˆÙŠØªØ±
        </a>
    </div>
</div>


<!-- âœ… Ø±Ø³Ø§Ù„Ø© Ù…Ù†ØªØµÙ Ø§Ù„Ø´Ø§Ø´Ø© -->
<div id="messageBox" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.2); z-index: 2000;">
    <p id="messageText" style="margin: 0; color: black;">Ø®Ø±ÙŠØ·Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø·Ø§Ø¦Ù!</p>
    <button onclick="closeMessage()" style="margin-top: 10px;">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<script>
    // ğŸ”µ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ø¹Ø¯Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
    const maxHistory = 5;
    
    // ğŸ”µ Ø¯Ø§Ù„Ø© Ù„Ø­ÙØ¸ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ localStorage
    function saveSearch(query) {
        if (!query) return;
    
        let searchHistory = JSON.parse(localStorage.getItem("searchHistory")) || [];
    
        if (!searchHistory.includes(query)) {
            searchHistory.unshift(query);
        }
    
        if (searchHistory.length > maxHistory) {
            searchHistory.pop();
        }
    
        localStorage.setItem("searchHistory", JSON.stringify(searchHistory));
    }
    
    // ğŸ”µ Ø¯Ø§Ù„Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø¹Ù†ØµØ±
    function searchFromHistory(name) {
        const input = document.getElementById("searchInput");
        if (input) {
            input.value = name;
            searchBuilding(); // ğŸ”¥ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ù…Ø¨Ø§Ø´Ø±Ø©
        }
    }
    
    // ğŸ”µ Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø£Ù…Ø§ÙƒÙ†ÙŠ
    function displaySearchHistory() {
        const searchHistory = JSON.parse(localStorage.getItem("searchHistory")) || [];
        const placesContent = document.getElementById("placesContent");
    
        if (!placesContent) return;
    
        const lang = document.documentElement.lang || 'ar';
        const t = translations[lang] || {};
    
        if (searchHistory.length === 0) {
            placesContent.innerHTML = `<p style="text-align:center; color:gray;">${t.noSearches || "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø¨Ø­Ø« Ø³Ø§Ø¨Ù‚Ø©."}</p>`;
        } else {
            const ul = document.createElement('ul');
            ul.style.listStyle = 'none';
            ul.style.padding = '0';
    
            searchHistory.slice().reverse().forEach(query => {
                const loweredQuery = query.toLowerCase().trim();
    
                const match = buildings.find(b =>
                    (b.name && b.name.toLowerCase().includes(loweredQuery)) ||
                    (b.enName && b.enName.toLowerCase().includes(loweredQuery))
                );
    
                const displayName = match ? (lang === 'ar' ? match.name : (match.enName || match.name)) : query;
    
                const li = document.createElement('li');
                li.textContent = displayName;
                li.style.padding = '8px';
                li.style.marginBottom = '5px';
                li.style.background = '#f0f0f0';
                li.style.borderRadius = '5px';
                li.style.textAlign = 'center';
                li.style.fontWeight = 'bold';
                li.style.cursor = 'pointer';
                li.style.transition = '0.3s'; // âœ… Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ù„Ø³ Ù„Ù„ØªÙˆÙ‡Ø¬
    
                // Ø¹Ù†Ø¯ ØªÙ…Ø±ÙŠØ± Ø§Ù„ÙØ£Ø±Ø© â” Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙˆÙ‡Ø¬
                li.addEventListener('mouseover', () => {
                    li.style.boxShadow = '0 0 10px #007bff'; // ğŸ”µ ØªÙˆÙ‡Ø¬ Ø£Ø²Ø±Ù‚ Ø®ÙÙŠÙ
                    li.style.background = '#e0eaff'; // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ© Ù…Ø¹ Ø§Ù„ØªÙˆÙ‡Ø¬
                });
    
                li.addEventListener('mouseout', () => {
                    li.style.boxShadow = 'none';
                    li.style.background = '#f0f0f0'; // ÙŠØ±Ø¬Ø¹ Ù„Ù„ÙˆÙ† Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
                });
    
                li.addEventListener('click', () => {
                    searchFromHistory(displayName);
                });
    
                ul.appendChild(li);
            });
    
            placesContent.innerHTML = `
                <h3 style="text-align:center;">${t.searchTitle || "Ø¢Ø®Ø± Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø­Ø«"}:</h3>
            `;
            placesContent.appendChild(ul);
        }
    }
    
    // ğŸ”µ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø­Ø« Ø£Ùˆ Ø²Ø± Ø¥Ù†ØªØ±
    function handleSearch() {
        const input = document.getElementById("searchInput").value.trim();
        if (input) {
            saveSearch(input);
            searchBuilding();
            displaySearchHistory();
        } else {
            alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„Ù„Ø¨Ø­Ø«.");
        }
    }
    
    // Ø²Ø± Ø§Ù„Ø¨Ø­Ø«
    document.getElementById("searchButton").addEventListener("click", handleSearch);
    
    // Ø²Ø± Enter ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
    document.getElementById("searchInput").addEventListener("keypress", function (e) {
        if (e.key === "Enter") {
            handleSearch();
        }
    });
    
    // ğŸ”µ Ø¹Ù†Ø¯ ÙØªØ­ Ù‚Ø³Ù… Ø£Ù…Ø§ÙƒÙ†ÙŠ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
    const placesIcon = document.querySelector(".icon[onclick*='places']");
    if (placesIcon) {
        placesIcon.addEventListener("click", displaySearchHistory);
    }
    </script>
    

<script src="/buildings-data.js"></script> <!-- ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ Ù‡Ù†Ø§ -->
<script>
    function showCategory(category) {
        if (!buildingLayers || buildingLayers.length === 0) {
            alert("Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù„Ù… ØªÙƒØªÙ…Ù„ Ø¨Ø¹Ø¯.");
            return;
        }
    
        // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø© (dir)
        const isArabic = document.documentElement.getAttribute("dir") === "rtl";
    
        // Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ ÙˆØ§Ù„Ù„ØºØ©
        const categories = {
            college: {
                ar: ["ÙƒÙ„ÙŠØ©"],
                en: ["College"]
            },
            admin: {
                ar: ["Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"],
                en: ["Administration"]
            },
            medical: {
                ar: ["Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ©"],
                en: ["Medical Administration", "Medical Admin"]
            },
            library: {
                ar: ["Ù…ÙƒØªØ¨Ø©", "Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª"],
                en: ["Library", "Libraries"]
            },
            mosque: {
                ar: ["Ù…Ø³Ø¬Ø¯", "Ø§Ù„Ù…Ø³Ø§Ø¬Ø¯"],
                en: ["Mosque", "Mosques"]
            },
            restaurant: {
                ar: ["Ù…Ø·Ø¹Ù…", "Ø§Ù„Ù…Ø·Ø¹Ù…"],
                en: ["Restaurant"]
            }
        };
    
        // Ø­Ø¯Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªØµÙ†ÙŠÙ ÙˆØ§Ù„Ù„ØºØ©
        const keywords = categories[category] ? (isArabic ? categories[category].ar : categories[category].en) : [];
    
        if (keywords.length === 0) {
            return; // Ù„Ø§ Ø´ÙŠØ¡ Ù„Ù„Ø¨Ø­Ø«
        }
    
        let found = false;
    
        buildingLayers.forEach(obj => {
            const name = (obj.feature.name || "").toLowerCase();
    
            if (keywords.some(kw => name.includes(kw.toLowerCase()))) {
                if (obj.layer && obj.layer.bindPopup) {
                    obj.layer.bindPopup(obj.feature.name).openPopup();
                }
    
                const path = obj.layer.getElement && obj.layer.getElement();
                if (path) {
                    path.classList.add('glow-path');
                    obj.layer.setStyle({ weight: 5 });
                    setTimeout(() => {
                        path.classList.remove('glow-path');
                        obj.layer.setStyle(obj.originalStyle);
                    }, 3000);
                }
                found = true;
            }
        });
    
        if (!found) {
            alert(isArabic ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ù†Ù Ù…Ø·Ø§Ø¨Ù‚Ø©.' : 'No matching buildings found.');
        }
    }
    </script>
    
    <script>
        function resetRoute() {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¯Ø¨Ø§Ø¨ÙŠØ³ Ø¥Ù† ÙˆØ¬Ø¯Øª
            if (startMarker) {
                map.removeLayer(startMarker);
                startMarker = null;
            }
            if (endMarker) {
                map.removeLayer(endMarker);
                endMarker = null;
            }
        
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ø· Ø¥Ù† ÙˆØ¬Ø¯
            if (routeLine) {
                map.removeLayer(routeLine);
                routeLine = null;
            }
        
            // ØªØµÙÙŠØ± Ø§Ù„Ù…Ø³Ø§ÙØ©
            document.getElementById('distanceInfo').innerText = "Ø§Ù„Ù…Ø³Ø§ÙØ© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Ù‚Ø·ØªÙŠÙ†...";
        }
        </script>
        
    
<!-- âœ… Ø¨ÙˆØ¨ Ø§Ø¨ Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ù‚Ù… -->
<div id="numberPopup" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%);
background:white; padding:20px; border-radius:12px; box-shadow:0 0 30px rgba(0,0,0,0.4); z-index:9999;
text-align:center; font-size:18px; min-width:250px;">
    <div id="popupContent"></div>
    <button onclick="closePopup()" style="margin-top:10px; padding:5px 20px; border:none; border-radius:8px; background:#007bff; color:white; cursor:pointer;">Ù…ÙˆØ§ÙÙ‚</button>
</div>
<script>
    let startMarker = null;
    let endMarker = null;
    let routeLine = null;
    
    // Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø§Ø±ÙƒØ± draggable
    function createDraggableMarker(latlng, color) {
        return L.marker(latlng, {
            draggable: true,
            icon: L.icon({
                iconUrl: `https://chart.googleapis.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|${color}`,
                iconSize: [30, 50],
                iconAnchor: [15, 50],
            })
        }).addTo(map);
    }
    
    // âœ… Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ¯ Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø¨Ø¯ÙˆÙ† Ø±Ø³Ø§Ù„Ø©
    function setStartPoint() {
        map.getContainer().classList.add('cursor-pin'); // ØªØºÙŠÙŠØ± Ø´ÙƒÙ„ Ø§Ù„Ù…Ø§ÙˆØ³ ÙÙ‚Ø·
    
        map.once('click', function(e) {
            if (startMarker) map.removeLayer(startMarker);
    
            startMarker = createDraggableMarker(e.latlng, '28a745'); // Ø¯Ø¨ÙˆØ³ Ø£Ø®Ø¶Ø±
            startMarker.on('dragend', updateRoute);
    
            map.getContainer().classList.remove('cursor-pin'); // Ø±Ø¬Ø¹ Ø§Ù„Ù…Ø§ÙˆØ³ Ø·Ø¨ÙŠØ¹ÙŠ
            updateRoute();
        });
    }
    
    // âœ… Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ¯ Ù†Ù‚Ø·Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø¨Ø¯ÙˆÙ† Ø±Ø³Ø§Ù„Ø©
    function setEndPoint() {
        map.getContainer().classList.add('cursor-pin'); // ØªØºÙŠÙŠØ± Ø´ÙƒÙ„ Ø§Ù„Ù…Ø§ÙˆØ³ ÙÙ‚Ø·
    
        map.once('click', function(e) {
            if (endMarker) map.removeLayer(endMarker);
    
            endMarker = createDraggableMarker(e.latlng, 'dc3545'); // Ø¯Ø¨ÙˆØ³ Ø£Ø­Ù…Ø±
            endMarker.on('dragend', updateRoute);
    
            map.getContainer().classList.remove('cursor-pin'); // Ø±Ø¬Ø¹ Ø§Ù„Ù…Ø§ÙˆØ³ Ø·Ø¨ÙŠØ¹ÙŠ
            updateRoute();
        });
    }
    
    // âœ… Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ø§Ù„Ø®Ø· ÙˆØ­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ©
    function updateRoute() {
        if (startMarker && endMarker) {
            const startLatLng = startMarker.getLatLng();
            const endLatLng = endMarker.getLatLng();
    
            // Ø­Ø°Ù Ø§Ù„Ø®Ø· Ø§Ù„Ù‚Ø¯ÙŠÙ… Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯
            if (routeLine) {
                map.removeLayer(routeLine);
            }
    
            // Ø±Ø³Ù… Ø®Ø· Ø¬Ø¯ÙŠØ¯
            routeLine = L.polyline([startLatLng, endLatLng], {color: 'blue', weight: 5}).addTo(map);
    
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ©
            const distance = map.distance(startLatLng, endLatLng);
            const distanceText = (distance > 1000)
                ? (distance / 1000).toFixed(2) + " ÙƒÙ…"
                : Math.round(distance) + " Ù…ØªØ±";
    
            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³Ø§ÙØ©
            document.getElementById('distanceInfo').innerText = `Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ù†Ù‚Ø·ØªÙŠÙ†: ${distanceText}`;
    
            // ØªÙˆØ³ÙŠØ· Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø±
            map.fitBounds(routeLine.getBounds(), {padding: [50, 50]});
        }
    }
    </script>
    
    
    <script>
        let buildingLayers = [];
        
        // ØªØ­Ù…ÙŠÙ„ Ø®Ø±ÙŠØ·Ø© GeoJSON
        fetch('tu_map_force_colored.geojson')
            .then(res => res.json())
            .then(data => {
                L.geoJSON(data, {
                    filter: function(feature) {
                        // âœ… ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ù†Ù‚Ø§Ø· (Point) ÙˆÙ„Ø§ ØªØ±Ø³Ù… Ø¥Ù„Ø§ Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ (Polygon/MultiPolygon)
                        return feature.geometry.type !== 'Point';
                    },
                    style: function(feature) {
                        const props = feature.properties || {};
        
                        if (props.name === "Ø¬Ø§Ù…Ø¹Ù‡ Ø§Ù„Ø·Ø§Ø¦Ù - Ø·Ù„Ø§Ø¨") {
                            return {
                                color: "blue",
                                opacity: 1,
                                weight: 3,
                                stroke: true,
                                fill: false,
                                fillColor: "transparent",
                                fillOpacity: 0
                            };
                        }
        
                        return {
                            color: props.borderColor || "#888",
                            weight: 2,
                            fillColor: props.fillColor || "#888",
                            fillOpacity: 0.4
                        };
                    },
                    onEachFeature: function(feature, layer) {
                        const props = feature.properties || {};
        
                        if (props.name) {
                            layer.bindPopup(props.name);
                        }
        
                        buildingLayers.push({
                            layer: layer,
                            feature: props,
                            originalStyle: {
                                weight: layer.options.weight,
                                color: layer.options.color,
                                fillColor: layer.options.fillColor,
                                fillOpacity: layer.options.fillOpacity,
                                opacity: layer.options.opacity
                            }
                        });
        
                        layer.on('mouseover', function() {
                            const path = layer.getElement && layer.getElement();
                            if (path) {
                                path.classList.add('glow-path');
                                const original = buildingLayers.find(b => b.layer === layer).originalStyle;
                                layer.setStyle({ 
                                    weight: 8, 
                                    color: original.color 
                                });
                            }
                        });
        
                        layer.on('mouseout', function() {
                            const path = layer.getElement && layer.getElement();
                            if (path) {
                                path.classList.remove('glow-path');
                                const original = buildingLayers.find(b => b.layer === layer).originalStyle;
                                layer.setStyle(original);
                            }
                        });
                    }
                }).addTo(map);
        
                loadingMessage.style.display = 'none';
            })
            .catch(error => {
                loadingMessage.innerHTML = 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
                console.error('GeoJSON Load Error:', error);
            });
        
        // ğŸ”„ Ø¯Ø§Ù„Ø© ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø§Ø³Ù…
        function cleanName(name) {
            return name.replace(/^[\(\d\)\-\s]+/, '').trim().toLowerCase();
        }
        
        // âœ… Ø¯Ø§Ù„Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø¨ÙˆØ¨ Ø£Ø¨ Ø§Ù„Ù‚Ø§Ø¹Ø©
        function showNumberPopup(building, floor, room) {
            const popupContent = document.getElementById('popupContent');
            popupContent.innerHTML = `
                <div>ğŸ¢ <strong>Ø§Ù„Ù…Ø¨Ù†Ù‰:</strong> ${building}</div>
                <div>ğŸ¬ <strong>Ø§Ù„Ø¯ÙˆØ±:</strong> ${floor}</div>
                <div>ğŸ›ï¸ <strong>Ø§Ù„Ù‚Ø§Ø¹Ø©:</strong> ${room}</div>
            `;
            document.getElementById('numberPopup').style.display = 'block';
        }
        
        // âœ… Ø¯Ø§Ù„Ø© Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¨ÙˆØ¨ Ø£Ø¨
        function closePopup() {
            document.getElementById('numberPopup').style.display = 'none';
        }
        
        // ğŸ” Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¨Ù†Ù‰
        function searchBuilding() {
            const input = document.getElementById('searchInput').value.trim();
            if (!input) return;
        
            const loweredInput = input.toLowerCase();
            const isNumber = !isNaN(loweredInput);
            let matchedBuilding = null;
        
            if (isNumber) {
                const num = parseInt(loweredInput);
        
                if (input.length === 4) {
                    const building = parseInt(input.charAt(0));
                    const floor = parseInt(input.charAt(1));
                    const room = input.substring(2);
                    showNumberPopup(building, floor, room);
                } else if (input.length === 5) {
                    const building = parseInt(input.substring(0, 2));
                    const floor = parseInt(input.charAt(2));
                    const room = input.substring(3);
                    showNumberPopup(building, floor, room);
                }
        
                matchedBuilding = buildings.find(b => {
                    return (b.room && num >= b.room && num <= b.room + 499) ||
                           (b.shortRoom && String(b.shortRoom) === String(num));
                });
            } else {
                matchedBuilding = buildings.find(b =>
                    (b.name && b.name.toLowerCase().includes(loweredInput)) ||
                    (b.enName && b.enName.toLowerCase().includes(loweredInput))
                );
            }
        
            if (!matchedBuilding) {
                alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¨Ù†Ù‰.');
                return;
            }
        
            const targetLayer = buildingLayers.find(obj => {
                const cleanGeoName = cleanName(obj.feature.name || "");
                const cleanTarget = cleanName(matchedBuilding.name || "");
                return cleanGeoName.includes(cleanTarget);
            });
        
            if (targetLayer) {
                if (targetLayer.layer.openPopup) {
                    targetLayer.layer.openPopup();
                }
        
                const path = targetLayer.layer.getElement && targetLayer.layer.getElement();
                if (path) {
                    path.classList.add('glow-path');
                    const original = targetLayer.originalStyle;
                    targetLayer.layer.setStyle({ 
                        weight: 8, 
                        color: original.color 
                    });
        
                    setTimeout(() => {
                        path.classList.remove('glow-path');
                        targetLayer.layer.setStyle(original);
                    }, 3000);
                }
            } else {
                alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ø¨Ù‚Ø© Ø§Ù„Ù…Ø¨Ù†Ù‰.');
            }
        }
        
        // ğŸ” Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø« Ø¨Ø²Ø± ÙˆØ¥Ø¯Ø®Ø§Ù„
        document.getElementById('searchButton').addEventListener('click', searchBuilding);
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchBuilding();
            }
        });
        </script>
        
        
        




<!-- âœ… Ø³ÙƒØ±Ø¨Øª Ø§Ù„ØªÙØ¹ÙŠÙ„ -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    function toggleSubSidebar(id) {
        document.querySelectorAll('.sub-sidebar').forEach(function (el) {
            el.style.display = (el.id === id && el.style.display !== 'block') ? 'block' : 'none';
        });
    }

    function showMessage() {
        document.getElementById('messageBox').style.display = 'block';
    }

    function closeMessage() {
        document.getElementById('messageBox').style.display = 'none';
    }
</script>
<script>
    const map = L.map('map').setView([21.433, 40.495], 17);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 20,
        attribution: 'Â© OpenStreetMap'
    }).addTo(map);

    const loadingMessage = document.getElementById('loadingMessage');
    loadingMessage.style.display = 'block';

    fetch('tu_map_force_colored.geojson')
        .then(res => {
            if (!res.ok) throw new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            return res.json();
        })
        .then(data => {
            L.geoJSON(data, {
                // âœ… Ø¥Ø¶Ø§ÙØ© ÙÙ„ØªØ± Ù„Ù…Ù†Ø¹ Ø±Ø³Ù… Ø§Ù„Ù†Ù‚Ø§Ø· (Point)
                filter: function (feature) {
                    return feature.geometry.type !== 'Point';
                },
                style: function (feature) {
                    const props = feature.properties || {};

                    if (props.name === "Ø¬Ø§Ù…Ø¹Ù‡ Ø§Ù„Ø·Ø§Ø¦Ù - Ø·Ù„Ø§Ø¨") {
                        return {
                            color: "blue",
                            weight: 3,
                            fill: false,
                            fillColor: "transparent",
                            fillOpacity: 0,
                            opacity: 1,
                            stroke: true
                        };
                    }

                    const color = props.borderColor || "#888";
                    return {
                        color: color,
                        weight: 2,
                        fillColor: color,
                        fillOpacity: 0.4
                    };
                },
                onEachFeature: function (feature, layer) {
                    const props = feature.properties || {};

                    if (props.name) {
                        layer.bindPopup(props.name);
                    }

                    // Ø¬Ø¹Ù„ ÙƒÙ„ Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ ÙˆØ§Ù„Ù…Ù†Ø§Ø·Ù‚ ØªØªÙˆÙ‡Ø¬ Ø¹Ù†Ø¯ Ø§Ù„ØªØ£Ø´ÙŠØ±
                    layer.on('mouseover', function () {
                        const path = layer.getElement && layer.getElement();
                        if (path) {
                            path.classList.add('glow-path');
                            layer.setStyle({ weight: 5 });
                        }
                    });

                    layer.on('mouseout', function () {
                        const path = layer.getElement && layer.getElement();
                        if (path) {
                            path.classList.remove('glow-path');
                            layer.setStyle({ weight: props.name === "Ø¬Ø§Ù…Ø¹Ù‡ Ø§Ù„Ø·Ø§Ø¦Ù - Ø·Ù„Ø§Ø¨" ? 3 : 2 });
                        }
                    });
                }
            }).addTo(map);

            loadingMessage.style.display = 'none';
        })
        .catch(error => {
            loadingMessage.innerHTML = 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
            console.error('GeoJSON Load Error:', error);
        });
</script>


  <script>
    const translations = {
        ar: {
            explore: "Ø§Ø³ØªÙƒØ´Ø§Ù",
            buildings: "Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ",
            medical_admin: "Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ©",
            food: "Ø§Ù„Ø·Ø¹Ø§Ù…",
            places: "Ø£Ù…Ø§ÙƒÙ†ÙŠ",
            directions: "Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª",
            reset: "Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†",
            setStart: "ØªØ­Ø¯ÙŠØ¯ Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©",
            setEnd: "ØªØ­Ø¯ÙŠØ¯ Ù†Ù‚Ø·Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ©",
            walking: "Ù…Ø´ÙŠØ§Ù‹",
            driving: "Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø©",
            showDirections: "Ø¹Ø±Ø¶ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª",
            events: "Ø§Ù„Ø£Ø­Ø¯Ø§Ø«",
            eventsInfo: "Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ¢Ø®Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§ØªØŒ Ù‚Ù… Ø¨Ø²ÙŠØ§Ø±Ø© ØµÙØ­Ø© ØªÙˆÙŠØªØ± Ø§Ù„Ø±Ø³Ù…ÙŠØ©:",
            visitTwitter: "Ø²ÙŠØ§Ø±Ø© ØªÙˆÙŠØªØ±",
            startPlaceholder: "Ø§Ø¨Ø­Ø« Ø£Ùˆ Ø§Ù†Ù‚Ø± ÙÙˆÙ‚ Ø§Ù„Ø®Ø±ÙŠØ·Ø©...",
            endPlaceholder: "Ø§Ø¨Ø­Ø« Ø£Ùˆ Ø§Ù†Ù‚Ø± ÙÙˆÙ‚ Ø§Ù„Ø®Ø±ÙŠØ·Ø©...",
            search: "Ø¨Ø­Ø«",
            searchPlaceholder: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø¨Ù†Ù‰...",
            welcome: "Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø·Ø§Ø¦Ù",
            loading: "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„",
            messageText: "Ø®Ø±ÙŠØ·Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø·Ø§Ø¦Ù!",
            colleges: "Ø§Ù„ÙƒÙ„ÙŠØ§Øª",
            admin: "Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©",
            library: "Ø§Ù„Ù…ÙƒØªØ¨Ø©",
            mosques: "Ø§Ù„Ù…Ø³Ø§Ø¬Ø¯",
            searchTitle: "Ø¢Ø®Ø± Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø­Ø«",
            noSearches: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø¨Ø­Ø« Ø³Ø§Ø¨Ù‚Ø©.",
            college: "ÙƒÙ„ÙŠØ©",
            administration: "Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©",
            medicalAdministration: "Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ©",
            libraryBuilding: "Ø§Ù„Ù…ÙƒØªØ¨Ø©",
            mosque: "Ø§Ù„Ù…Ø³Ø¬Ø¯",
            restaurant: "Ø§Ù„Ù…Ø·Ø¹Ù…",
            distanceInfo: "Ø§Ù„Ù…Ø³Ø§ÙØ© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Ù‚Ø·ØªÙŠÙ†..."

        },
        en: {
            explore: "Explore",
            buildings: "Buildings",
            medical_admin: "Medical Administration",
            food: "Food",
            places: "My Places",
            directions: "Directions",
            reset: "Reset",
            setStart: "Set Start Point",
            setEnd: "Set End Point",
            walking: "Walking",
            driving: "Driving",
            showDirections: "Show Directions",
            events: "Events",
            eventsInfo: "For events and latest updates, visit the official Twitter page:",
            visitTwitter: "Visit Twitter",
            startPlaceholder: "Search or click on the map...",
            endPlaceholder: "Search or click on the map...",
            search: "Search",
            searchPlaceholder: "Search for a building...",
            welcome: "Welcome to Taif University",
            loading: "Loading...",
            messageText: "Interactive map of Taif University!",
            colleges: "Colleges",
            admin: "Administration",
            library: "Library",
            mosques: "Mosques",
            searchTitle: "Recent Searches",
            noSearches: "No recent searches.",
            college: "College",
            administration: "Administration",
            medicalAdministration: "Medical Administration",
            libraryBuilding: "Library",
            mosque: "Mosque",
            restaurant: "Restaurant",
            distanceInfo: "The distance will appear here after selecting two points..."

        }
    };
    
    
    function setLanguage(lang) {
        const allKeys = document.querySelectorAll("[data-key]");
        allKeys.forEach(el => {
            const key = el.getAttribute("data-key");
            if (translations[lang][key]) {
                el.textContent = translations[lang][key];
            }
        });
    
        // ØªØºÙŠÙŠØ± placeholder Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø«
        const searchInput = document.getElementById("searchInput");
        if (searchInput) {
            searchInput.setAttribute("placeholder", translations[lang]["searchPlaceholder"]);
        }
    
        // ØªØºÙŠÙŠØ± Ù†Øµ Ø²Ø± Ø§Ù„Ø¨Ø­Ø«
        const searchButton = document.getElementById("searchButton");
        if (searchButton) {
            searchButton.textContent = translations[lang]["search"];
        }
    
        // ØªØºÙŠÙŠØ± Ù…Ø­ØªÙˆÙ‰ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
        const messageText = document.getElementById("messageText");
        if (messageText) {
            messageText.textContent = translations[lang]["messageText"];
        }
    }
    </script>
    
  <script>
    // Ø±Ø¨Ø· Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¨Ø­Ø«
    const searchInput = document.getElementById("searchInput");
    const suggestionsList = document.getElementById("suggestionsList");
    
    // ØªÙˆÙ„ÙŠØ¯ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù…Ù† Ù…Ù„Ù buildings-data.js
    const suggestions = buildings.map(b => ({
        ar: b.name || "",
        en: b.enName || ""
    }));
    
    let selectedIndex = -1;
    
    // Ø¹Ù†Ø¯ Ø§Ù„ÙƒØªØ§Ø¨Ø©
    searchInput.addEventListener("input", function () {
        const query = this.value.trim().toLowerCase();
        suggestionsList.innerHTML = "";
        selectedIndex = -1;
    
        if (!query) {
            suggestionsList.style.display = "none";
            return;
        }
    
        const isArabic = /^[\u0600-\u06FF\s\d]+$/.test(query);
        const langKey = isArabic ? "ar" : "en";
    
        const filtered = suggestions.filter(item =>
            item[langKey].toLowerCase().includes(query)
        );
    
        if (filtered.length > 0) {
            filtered.forEach(item => {
                const li = document.createElement("li");
                li.textContent = item[langKey];
                li.classList.add("suggestion-item");
                li.addEventListener("click", function () {
                    searchInput.value = item[langKey];
                    suggestionsList.style.display = "none";
                    searchBuilding();
                });
                suggestionsList.appendChild(li);
            });
            suggestionsList.style.display = "block";
        } else {
            suggestionsList.style.display = "none";
        }
    });
    
    // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¨Ø§Ù„Ø£Ø³Ù‡Ù… ÙˆØ§Ù„Ø¥Ù†ØªØ±
    searchInput.addEventListener("keydown", function (event) {
        const items = suggestionsList.querySelectorAll("li");
        if (suggestionsList.style.display === "block" && items.length > 0) {
            if (event.key === "ArrowDown") {
                event.preventDefault();
                if (selectedIndex < items.length - 1) {
                    selectedIndex++;
                    updateSelection(items);
                }
            } else if (event.key === "ArrowUp") {
                event.preventDefault();
                if (selectedIndex > 0) {
                    selectedIndex--;
                    updateSelection(items);
                }
            } else if (event.key === "Enter") {
                event.preventDefault();
                if (selectedIndex >= 0 && selectedIndex < items.length) {
                    searchInput.value = items[selectedIndex].textContent;
                    suggestionsList.style.display = "none";
                }
                searchBuilding();
            }
        }
    });
    
    // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ¯
    function updateSelection(items) {
        items.forEach((item, index) => {
            if (index === selectedIndex) {
                item.classList.add("highlight");
                item.scrollIntoView({ block: "nearest" });
            } else {
                item.classList.remove("highlight");
            }
        });
    }
    
    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¨Ø§Ù„Ø®Ø§Ø±Ø¬
    document.addEventListener("click", function (e) {
        if (!document.querySelector(".search-container").contains(e.target)) {
            suggestionsList.style.display = "none";
        }
    });
    </script>
    

</body>
</html>
